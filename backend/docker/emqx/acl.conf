## FaithFlow MQTT ACL Rules (EMQX 5.x Format)
##
## These rules control which topics users can publish/subscribe to.
## Format: {allow|deny, who, action, topics}
##
## Topic Structure:
##   faithflow/{church_id}/presence/{member_id}
##   faithflow/{church_id}/community/{community_id}/announcements
##   faithflow/{church_id}/community/{community_id}/general
##   faithflow/{church_id}/community/{community_id}/subgroup/{subgroup_id}
##   faithflow/{church_id}/community/{community_id}/typing
##   faithflow/{church_id}/community/{community_id}/read
##   faithflow/{church_id}/community/{community_id}/reactions

## ============================================================================
## ALLOW RULES
## ============================================================================

## System client can do everything
{allow, {username, "faithflow-system"}, all, ["#"]}.

## All authenticated users can subscribe to their church topics
{allow, all, subscribe, ["faithflow/#"]}.

## All authenticated users can publish to community channels
{allow, all, publish, ["faithflow/+/presence/+"]}.
{allow, all, publish, ["faithflow/+/community/+/general"]}.
{allow, all, publish, ["faithflow/+/community/+/subgroup/+"]}.
{allow, all, publish, ["faithflow/+/community/+/announcements"]}.
{allow, all, publish, ["faithflow/+/community/+/typing"]}.
{allow, all, publish, ["faithflow/+/community/+/read"]}.
{allow, all, publish, ["faithflow/+/community/+/reactions"]}.

## ============================================================================
## DENY RULES
## ============================================================================

## Deny everything else
{deny, all}.
