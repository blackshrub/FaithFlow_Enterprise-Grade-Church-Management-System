# ============================================================================
# coTURN Server Configuration
# ============================================================================
# TURN (Traversal Using Relays around NAT) server configuration
# Used as a relay when direct peer-to-peer connection fails
#
# Documentation: https://github.com/coturn/coturn
#
# For production, update:
# 1. realm: Your domain
# 2. external-ip: Your server's public IP
# 3. static-auth-secret: Generate strong secret
# 4. cert/pkey: SSL certificates for TLS
# ============================================================================

# ==========================================================================
# Listener Configuration
# ==========================================================================

# TURN listener port for UDP and TCP
listening-port=3478

# TURN listener port for TLS
tls-listening-port=5349

# Alternative listening port (for load balancing)
# alt-listening-port=3479
# alt-tls-listening-port=5350

# Listener IP addresses (0.0.0.0 = all interfaces)
listening-ip=0.0.0.0

# Relay IP address range (for Docker, use host network or set specific IPs)
relay-ip=0.0.0.0

# External IP address (REQUIRED for NAT traversal)
# Set to your server's public IP in production
# external-ip=YOUR_PUBLIC_IP

# ==========================================================================
# Relay Configuration
# ==========================================================================

# Relay port range (UDP) - Limited range to avoid conflicts
min-port=49152
max-port=49200

# ==========================================================================
# Authentication
# ==========================================================================

# Realm (your domain)
realm=faithflow.local

# Use long-term credentials mechanism
lt-cred-mech

# Static authentication secret for REST API
# Generate with: openssl rand -hex 32
static-auth-secret=faithflow-turn-secret-change-in-production

# User credentials (alternative to static-auth-secret)
# Format: user=username:password
# user=turnuser:turnpassword

# ==========================================================================
# Security
# ==========================================================================

# Fingerprinting (recommended)
fingerprint

# Disable old TLS versions
no-tlsv1
no-tlsv1_1

# SSL certificate paths (for TLS)
# cert=/etc/ssl/certs/turn.pem
# pkey=/etc/ssl/private/turn.key

# Disable weak ciphers
# cipher-list="ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256"

# ==========================================================================
# Performance
# ==========================================================================

# Number of relay threads
relay-threads=4

# Maximum allocation time (seconds)
max-allocate-lifetime=3600

# Channel lifetime
channel-lifetime=600

# Permission lifetime
permission-lifetime=300

# Stale nonce timeout
stale-nonce=600

# ==========================================================================
# Logging
# ==========================================================================

# Log file
# log-file=/var/log/turnserver.log

# Verbose logging (for debugging)
# verbose

# Enable stdout logging (for Docker)
log-file=stdout

# Syslog logging
# syslog

# ==========================================================================
# Bandwidth Limits
# ==========================================================================

# Maximum bandwidth per session (bytes per second)
# 0 = unlimited
max-bps=3000000

# Total bandwidth limit
# total-quota=100

# ==========================================================================
# Security Restrictions
# ==========================================================================

# Disable TCP relay (only UDP)
# no-tcp-relay

# Disable UDP relay (only TCP)
# no-udp-relay

# Deny peers from private networks (recommended for production)
# denied-peer-ip=10.0.0.0-10.255.255.255
# denied-peer-ip=172.16.0.0-172.31.255.255
# denied-peer-ip=192.168.0.0-192.168.255.255

# Allowed peer IPs (if you want to restrict)
# allowed-peer-ip=0.0.0.0-255.255.255.255

# ==========================================================================
# Mobility Support (for mobile clients)
# ==========================================================================

# Allow mobility (IP address changes during session)
mobility

# ==========================================================================
# Additional Options
# ==========================================================================

# Use authentication for TURN only (allow anonymous STUN)
# stun-only

# Disable STUN functionality (TURN only)
# no-stun

# Enable Simple Traversal of UDP through NAT (RFC 3489)
# simple-log

# Process user allocation quotas
# user-quota=12

# Total user quota
# total-quota=100
