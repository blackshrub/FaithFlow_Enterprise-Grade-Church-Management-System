# FaithFlow log rotation configuration
# Install to: /etc/logrotate.d/faithflow

/var/log/faithflow/*.log {
    # Rotate daily
    daily

    # Keep 30 days of logs
    rotate 30

    # Compress old logs
    compress
    delaycompress

    # Don't error if log file is missing
    missingok

    # Don't rotate if empty
    notifempty

    # Create new log file with these permissions after rotation
    create 0644 root root

    # Date extension for rotated logs (e.g., backend.out.log-20250123)
    dateext
    dateformat -%Y%m%d

    # Restart services after rotation to reopen log files
    postrotate
        systemctl reload-or-restart faithflow-backend.service > /dev/null 2>&1 || true
        systemctl reload-or-restart faithflow-frontend.service > /dev/null 2>&1 || true
    endscript
}
